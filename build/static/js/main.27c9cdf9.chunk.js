(this["webpackJsonpimagekit.io-drive"]=this["webpackJsonpimagekit.io-drive"]||[]).push([[0],{71:function(e,t,a){e.exports=a(90)},90:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(22),c=a.n(l),o=a(16),u=a.n(o),i=a(26),s=a(6),m=a(104),d=a(95),f=a(99),p=a(96),E=a(12),b=a(55),h=a.n(b),v=(a(77),a(79),a(91),h.a.initializeApp({apiKey:"AIzaSyC7rZIuAiE45svBVzSwZisjtFZ-CGrW_4Y",authDomain:"drive-clone-2ada7.firebaseapp.com",projectId:"drive-clone-2ada7",storageBucket:"drive-clone-2ada7.appspot.com",messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_FIREBASE_API_KEY:"AIzaSyC7rZIuAiE45svBVzSwZisjtFZ-CGrW_4Y",REACT_APP_FIREBASE_APP_ID:"1:917499596016:web:24abd526f6c7322dfd8635",REACT_APP_FIREBASE_AUTH_DOMAIN:"drive-clone-2ada7.firebaseapp.com",REACT_APP_FIREBASE_DATABASE_URL:"https://drive-clone-2ada7.firebaseio.com",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"917499596016",REACT_APP_FIREBASE_PROJECT_ID:"drive-clone-2ada7",REACT_APP_FIREBASE_STORAGE_BUCKET:"drive-clone-2ada7.appspot.com"}).REACT_APP_FIREBASE_SENDER_ID,appId:"1:917499596016:web:24abd526f6c7322dfd8635"})),g=v.firestore(),O={folders:g.collection("folders"),files:g.collection("files"),formatDoc:function(e){return Object(E.a)({id:e.id},e.data())},getCurrentTimestamp:h.a.firestore.FieldValue.serverTimestamp},j=(v.firestore(),v.storage()),y=v.auth(),w=r.a.createContext();function x(){return Object(n.useContext)(w)}function S(e){var t=e.children,a=Object(n.useState)(),l=Object(s.a)(a,2),c=l[0],o=l[1],u=Object(n.useState)(!0),i=Object(s.a)(u,2),m=i[0],d=i[1];Object(n.useEffect)((function(){return y.onAuthStateChanged((function(e){o(e),d(!1)}))}),[]);var f={currentUser:c,login:function(e,t){return y.signInWithEmailAndPassword(e,t)},signup:function(e,t){return y.createUserWithEmailAndPassword(e,t)},logout:function(){return y.signOut()},resetPassword:function(e){return y.sendPasswordResetEmail(e)},updateEmail:function(e){return c.updateEmail(e)},updatePassword:function(e){return c.updatePassword(e)}};return r.a.createElement(w.Provider,{value:f},!m&&t)}var C=a(9),A=a(8),P=a(94);function I(e){var t=e.children;return r.a.createElement(P.a,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"100vh"}},r.a.createElement("div",{className:"w-100",style:{maxWidth:"400px"}},t))}function N(){var e=Object(n.useRef)(),t=Object(n.useRef)(),a=Object(n.useRef)(),l=x().signup,c=Object(n.useState)(""),o=Object(s.a)(c,2),E=o[0],b=o[1],h=Object(n.useState)(!1),v=Object(s.a)(h,2),g=v[0],O=v[1],j=Object(C.g)();function y(){return(y=Object(i.a)(u.a.mark((function n(r){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.preventDefault(),t.current.value===a.current.value){n.next=3;break}return n.abrupt("return",b("Passwords do not match"));case 3:return n.prev=3,b(""),O(!0),n.next=8,l(e.current.value,t.current.value);case 8:j.push("/"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),b("Failed to create an account");case 14:O(!1);case 15:case"end":return n.stop()}}),n,null,[[3,11]])})))).apply(this,arguments)}return r.a.createElement(I,null,r.a.createElement(m.a,null,r.a.createElement(m.a.Body,null,r.a.createElement("h2",{className:"text-center mb-4"},"Sign Up"),E&&r.a.createElement(d.a,{variant:"danger"},E),r.a.createElement(f.a,{onSubmit:function(e){return y.apply(this,arguments)}},r.a.createElement(f.a.Group,{id:"email"},r.a.createElement(f.a.Label,null,"Email"),r.a.createElement(f.a.Control,{type:"email",ref:e,required:!0})),r.a.createElement(f.a.Group,{id:"password"},r.a.createElement(f.a.Label,null,"Password"),r.a.createElement(f.a.Control,{type:"password",ref:t,required:!0})),r.a.createElement(f.a.Group,{id:"password-confirm"},r.a.createElement(f.a.Label,null,"Password Confirmation"),r.a.createElement(f.a.Control,{type:"password",ref:a,required:!0})),r.a.createElement(p.a,{disabled:g,className:"w-100",type:"submit"},"Sign Up")))),r.a.createElement("div",{className:"w-100 text-center mt-2"},"Already have an account? ",r.a.createElement(A.b,{to:"/login"},"Log In")))}function F(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],l=t[1],c=x(),o=c.currentUser,f=c.logout,E=Object(C.g)();function b(){return(b=Object(i.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(""),e.prev=1,e.next=4,f();case 4:E.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),l("Failed to log out");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}return r.a.createElement(I,null,r.a.createElement(m.a,null,r.a.createElement(m.a.Body,null,r.a.createElement("h2",{className:"text-center mb-4"},"Profile"),a&&r.a.createElement(d.a,{variant:"danger"},a),r.a.createElement("strong",null,"Email:")," ",o.email,r.a.createElement(A.b,{to:"/update-profile",className:"btn btn-primary w-100 mt-3"},"Update Profile"))),r.a.createElement("div",{className:"w-100 text-center mt-2"},r.a.createElement(p.a,{variant:"link",onClick:function(){return b.apply(this,arguments)}},"Log Out")))}function _(){var e=Object(n.useRef)(),t=Object(n.useRef)(),a=x().login,l=Object(n.useState)(""),c=Object(s.a)(l,2),o=c[0],E=c[1],b=Object(n.useState)(!1),h=Object(s.a)(b,2),v=h[0],g=h[1],O=Object(C.g)();function j(){return(j=Object(i.a)(u.a.mark((function n(r){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.prev=1,E(""),g(!0),n.next=6,a(e.current.value,t.current.value);case 6:O.push("/"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),E("Failed to log in");case 12:g(!1);case 13:case"end":return n.stop()}}),n,null,[[1,9]])})))).apply(this,arguments)}return r.a.createElement(I,null,r.a.createElement(m.a,null,r.a.createElement(m.a.Body,null,r.a.createElement("h2",{className:"text-center mb-4"},"Log In"),o&&r.a.createElement(d.a,{variant:"danger"},o),r.a.createElement(f.a,{onSubmit:function(e){return j.apply(this,arguments)}},r.a.createElement(f.a.Group,{id:"email"},r.a.createElement(f.a.Label,null,"Email"),r.a.createElement(f.a.Control,{type:"email",ref:e,required:!0})),r.a.createElement(f.a.Group,{id:"password"},r.a.createElement(f.a.Label,null,"Password"),r.a.createElement(f.a.Control,{type:"password",ref:t,required:!0})),r.a.createElement(p.a,{disabled:v,className:"w-100",type:"submit"},"Log In")),r.a.createElement("div",{className:"w-100 text-center mt-3"},r.a.createElement(A.b,{to:"/forgot-password"},"Forgot Password?")))),r.a.createElement("div",{className:"w-100 text-center mt-2"},"Need an account? ",r.a.createElement(A.b,{to:"/signup"},"Sign Up")))}var k=a(70);function R(e){var t=e.component,a=Object(k.a)(e,["component"]),n=x().currentUser;return r.a.createElement(C.b,Object.assign({},a,{render:function(e){return n?r.a.createElement(t,e):r.a.createElement(C.a,{to:"/login"})}}))}function B(){var e=Object(n.useRef)(),t=x().resetPassword,a=Object(n.useState)(""),l=Object(s.a)(a,2),c=l[0],o=l[1],E=Object(n.useState)(""),b=Object(s.a)(E,2),h=b[0],v=b[1],g=Object(n.useState)(!1),O=Object(s.a)(g,2),j=O[0],y=O[1];function w(){return(w=Object(i.a)(u.a.mark((function a(n){return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.prev=1,v(""),o(""),y(!0),a.next=7,t(e.current.value);case 7:v("Check your inbox for further instructions"),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(1),o("Failed to reset password");case 13:y(!1);case 14:case"end":return a.stop()}}),a,null,[[1,10]])})))).apply(this,arguments)}return r.a.createElement(I,null,r.a.createElement(m.a,null,r.a.createElement(m.a.Body,null,r.a.createElement("h2",{className:"text-center mb-4"},"Password Reset"),c&&r.a.createElement(d.a,{variant:"danger"},c),h&&r.a.createElement(d.a,{variant:"success"},h),r.a.createElement(f.a,{onSubmit:function(e){return w.apply(this,arguments)}},r.a.createElement(f.a.Group,{id:"email"},r.a.createElement(f.a.Label,null,"Email"),r.a.createElement(f.a.Control,{type:"email",ref:e,required:!0})),r.a.createElement(p.a,{disabled:j,className:"w-100",type:"submit"},"Reset Password")),r.a.createElement("div",{className:"w-100 text-center mt-3"},r.a.createElement(A.b,{to:"/login"},"Login")))),r.a.createElement("div",{className:"w-100 text-center mt-2"},"Need an account? ",r.a.createElement(A.b,{to:"/signup"},"Sign Up")))}function D(){var e=Object(n.useRef)(),t=Object(n.useRef)(),a=Object(n.useRef)(),l=x(),c=l.currentUser,o=l.updatePassword,u=l.updateEmail,i=Object(n.useState)(""),E=Object(s.a)(i,2),b=E[0],h=E[1],v=Object(n.useState)(!1),g=Object(s.a)(v,2),O=g[0],j=g[1],y=Object(C.g)();return r.a.createElement(I,null,r.a.createElement(m.a,null,r.a.createElement(m.a.Body,null,r.a.createElement("h2",{className:"text-center mb-4"},"Update Profile"),b&&r.a.createElement(d.a,{variant:"danger"},b),r.a.createElement(f.a,{onSubmit:function(n){if(n.preventDefault(),t.current.value!==a.current.value)return h("Passwords do not match");var r=[];j(!0),h(""),e.current.value!==c.email&&r.push(u(e.current.value)),t.current.value&&r.push(o(t.current.value)),Promise.all(r).then((function(){y.push("/user")})).catch((function(){h("Failed to update account")})).finally((function(){j(!1)}))}},r.a.createElement(f.a.Group,{id:"email"},r.a.createElement(f.a.Label,null,"Email"),r.a.createElement(f.a.Control,{type:"email",ref:e,required:!0,defaultValue:c.email})),r.a.createElement(f.a.Group,{id:"password"},r.a.createElement(f.a.Label,null,"Password"),r.a.createElement(f.a.Control,{type:"password",ref:t,placeholder:"Leave blank to keep the same"})),r.a.createElement(f.a.Group,{id:"password-confirm"},r.a.createElement(f.a.Label,null,"Password Confirmation"),r.a.createElement(f.a.Control,{type:"password",ref:a,placeholder:"Leave blank to keep the same"})),r.a.createElement(p.a,{disabled:O,className:"w-100",type:"submit"},"Update")))),r.a.createElement("div",{className:"w-100 text-center mt-2"},r.a.createElement(A.b,{to:"/user"},"Cancel")))}var T="select-folder",L="update-folder",U="set-child-folders",G="set-child-files",W={name:"Root",id:null,path:[]};function z(e,t){var a=t.type,n=t.payload;switch(a){case T:return{folderId:n.folderId,folder:n.folder,childFiles:[],childFolders:[]};case L:return Object(E.a)(Object(E.a)({},e),{},{folder:n.folder});case U:return Object(E.a)(Object(E.a)({},e),{},{childFolders:n.childFolders});case G:return Object(E.a)(Object(E.a)({},e),{},{childFiles:n.childFiles});default:return e}}var q=a(35),H=a(98),K=a(14),Z=a(15);function V(e){var t=e.currentFolder,a=Object(n.useState)(!1),l=Object(s.a)(a,2),c=l[0],o=l[1],u=Object(n.useState)(""),i=Object(s.a)(u,2),m=i[0],d=i[1],E=x().currentUser;function b(){o(!1)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{onClick:function(){o(!0)},variant:"outline-dark",size:"sm"},r.a.createElement(K.a,{icon:Z.e}),r.a.createElement("span",null," ")," Add Folder"),r.a.createElement(H.a,{show:c,onHide:b},r.a.createElement(f.a,{onSubmit:function(e){if(e.preventDefault(),null!=t){var a=Object(q.a)(t.path);t!==W&&a.push({name:t.name,id:t.id}),O.folders.add({name:m,parentId:t.id,userId:E.uid,path:a,createdAt:O.getCurrentTimestamp()}),d(""),b()}}},r.a.createElement(H.a.Body,null,r.a.createElement(f.a.Group,null,r.a.createElement(f.a.Label,null,"Folder Name"),r.a.createElement(f.a.Control,{type:"text",required:!0,value:m,onChange:function(e){return d(e.target.value)}}))),r.a.createElement(H.a.Footer,null,r.a.createElement(p.a,{variant:"secondary",onClick:b},"Close"),r.a.createElement(p.a,{variant:"success",type:"submit"},"Add Folder")))))}var M=a(103),J=a(101),Y=a(105);function Q(e){var t=e.currentFolder,a=Object(n.useState)([]),l=Object(s.a)(a,2),o=l[0],u=l[1],i=x().currentUser;return r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{className:"btn btn-outline-dark btn-sm m-0 mr-2"},r.a.createElement(K.a,{icon:Z.c}),r.a.createElement("span",null," ")," Add File",r.a.createElement("input",{type:"file",onChange:function(e){var a=e.target.files[0];if(null!=t&&null!=a){var n=Object(M.a)();u((function(e){return[].concat(Object(q.a)(e),[{id:n,name:a.name,progress:0,error:!1}])}));var r=t===W?"".concat(t.path.join("/"),"/").concat(a.name):"".concat(t.path.join("/"),"/").concat(t.name,"/").concat(a.name),l=j.ref("/files/".concat(i.uid,"/").concat(r)).put(a);l.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes;u((function(e){return e.map((function(e){return e.id===n?Object(E.a)(Object(E.a)({},e),{},{progress:t}):e}))}))}),(function(){u((function(e){return e.map((function(e){return e.id===n?Object(E.a)(Object(E.a)({},e),{},{error:!0}):e}))}))}),(function(){u((function(e){return e.filter((function(e){return e.id!==n}))})),l.snapshot.ref.getDownloadURL().then((function(e){O.files.where("name","==",a.name).where("userId","==",i.uid).where("folderId","==",t.id).get().then((function(n){var r=n.docs[0];r?r.ref.update({url:e}):O.files.add({url:e,name:a.name,size:a.size,type:a.type,createdAt:O.getCurrentTimestamp(),folderId:t.id,userId:i.uid})}))}))}))}},style:{opacity:0,position:"absolute",left:"-9999px"}})),o.length>0&&c.a.createPortal(r.a.createElement("div",{style:{position:"absolute",bottom:"1rem",left:"1rem",maxWidth:"250px"}},o.map((function(e){return r.a.createElement(J.a,{key:e.id,onClose:function(){u((function(t){return t.filter((function(t){return t.id!==e.id}))}))}},r.a.createElement(J.a.Header,{closeButton:e.error,className:"text-truncate w-100 d-block"},e.name),r.a.createElement(J.a.Body,null,r.a.createElement(Y.a,{animated:!e.error,variant:e.error?"danger":"primary",now:e.error?100:100*e.progress,label:e.error?"Error":"".concat(Math.round(100*e.progress),"%")})))}))),document.body))}var X=a(97),$=a(64);function ee(e){var t=e.folder,a=Object(n.useState)(!1),l=Object(s.a)(a,2),c=l[0],o=l[1],u=Object(n.useState)(""),i=Object(s.a)(u,2),d=i[0],E=i[1];function b(){o(!1)}return r.a.createElement(X.a,{className:"ml-2 mr-2"},r.a.createElement(m.a,{className:"p-2",style:{width:"18rem"}},r.a.createElement(X.a,{style:{display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement(p.a,{to:{pathname:"/folder/".concat(t.id),state:{folder:t}},variant:"light",className:"text-truncate w-75",as:A.b},r.a.createElement(K.a,{icon:Z.d,className:"mr-1"}),t.name)),r.a.createElement(X.a,{className:"mt-2",style:{display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement($.a,{lg:"3"},r.a.createElement(p.a,{variant:"success",onClick:function(){o(!0)}},r.a.createElement(K.a,{icon:Z.a})),r.a.createElement(H.a,{show:c,onHide:b},r.a.createElement(f.a,{onSubmit:function(e){e.preventDefault(),console.log(e),console.log(d),console.log(t.id),g.collection("folders").doc(t.id).update({name:d}),console.log(e.target.value),E(""),b()}},r.a.createElement(H.a.Body,null,r.a.createElement(f.a.Group,null,r.a.createElement(f.a.Label,null,"Change Folder Name"),r.a.createElement(f.a.Control,{type:"text",required:!0,value:d,onChange:function(e){return E(e.target.value)}}))),r.a.createElement(H.a.Footer,null,r.a.createElement(p.a,{variant:"secondary",onClick:b},"Close"),r.a.createElement(p.a,{variant:"success",type:"submit"},"Rename Folder"))))),r.a.createElement($.a,{lg:"3"},r.a.createElement(p.a,{variant:"danger",onClick:function(){return function(e){g.collection("folders").doc(e).delete().then((function(){console.log("Document successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}))}(t.id)}},r.a.createElement(K.a,{icon:Z.f}))))))}function te(e){var t=e.file;return r.a.createElement("a",{href:t.url,target:"_blank",className:"btn btn-outline-dark text-truncate w-100"},r.a.createElement(K.a,{icon:Z.b,className:"mr-2"}),t.name,r.a.createElement("br",null),"Size : ",(t.size/1024).toFixed(2)," KB",r.a.createElement("br",null),"Type : ",t.type)}var ae=a(102),ne=a(100);function re(){return r.a.createElement(ae.a,{bg:"light",expand:"sm"},r.a.createElement(ae.a.Brand,{as:A.b,to:"/"},"Imagekit.io Drive"),r.a.createElement(ne.a,{className:"ml-auto"},r.a.createElement(ne.a.Link,{as:A.b,to:"/user"},r.a.createElement(K.a,{icon:Z.g,className:"mr-2"}),"Profile")))}var le=a(106);function ce(e){var t=e.currentFolder,a=t===W?[]:[W];return t&&(a=[].concat(Object(q.a)(a),Object(q.a)(t.path))),r.a.createElement(le.a,{className:"flex-grow-1",listProps:{className:"bg-white pl-0 m-0"}},a.map((function(e,t){return r.a.createElement(le.a.Item,{key:e.id,linkAs:A.b,linkProps:{to:{pathname:e.id?"/folder/".concat(e.id):"/",state:{folder:Object(E.a)(Object(E.a)({},e),{},{path:a.slice(1,t)})}}},className:"text-truncate d-inline-block",style:{maxWidth:"150px"}},e.name)})),t&&r.a.createElement(le.a.Item,{className:"text-truncate d-inline-block",style:{maxWidth:"200px"},active:!0},t.name))}function oe(){var e=Object(C.i)().folderId,t=Object(C.h)().state,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=Object(n.useReducer)(z,{folderId:e,folder:t,childFolders:[],childFiles:[]}),r=Object(s.a)(a,2),l=r[0],c=r[1],o=x(),u=o.currentUser;return Object(n.useEffect)((function(){c({type:T,payload:{folderId:e,folder:t}})}),[e,t]),Object(n.useEffect)((function(){if(null==e)return c({type:L,payload:{folder:W}});O.folders.doc(e).get().then((function(e){c({type:L,payload:{folder:O.formatDoc(e)}})})).catch((function(){c({type:L,payload:{folder:W}})}))}),[e]),Object(n.useEffect)((function(){return O.folders.where("parentId","==",e).where("userId","==",u.uid).orderBy("createdAt").onSnapshot((function(e){c({type:U,payload:{childFolders:e.docs.map(O.formatDoc)}})}))}),[e,u]),Object(n.useEffect)((function(){return O.files.where("folderId","==",e).where("userId","==",u.uid).onSnapshot((function(e){c({type:G,payload:{childFiles:e.docs.map(O.formatDoc)}})}))}),[e,u]),l}(e,(void 0===t?{}:t).folder),l=a.folder,c=a.childFolders,o=a.childFiles;return r.a.createElement(r.a.Fragment,null,r.a.createElement(re,null),r.a.createElement(P.a,{fluid:!0},r.a.createElement("div",{className:"d-flex align-items-center"},r.a.createElement(ce,{currentFolder:l}),r.a.createElement(Q,{currentFolder:l}),r.a.createElement(V,{currentFolder:l})),c.length>0&&r.a.createElement("div",{className:"d-flex flex-wrap"},c.map((function(e){return r.a.createElement("div",{key:e.id,style:{maxWidth:"250px"},className:"p-2"},r.a.createElement(ee,{folder:e}))}))),c.length>0&&o.length>0&&r.a.createElement("hr",null),o.length>0&&r.a.createElement("div",{className:"d-flex flex-wrap"},o.map((function(e){return r.a.createElement("div",{key:e.id,style:{maxWidth:"250px"},className:"p-2"},r.a.createElement(te,{file:e}))})))))}var ue=function(){return r.a.createElement(A.a,null,r.a.createElement(S,null,r.a.createElement(C.d,null,r.a.createElement(R,{exact:!0,path:"/",component:oe}),r.a.createElement(R,{exact:!0,path:"/folder/:folderId",component:oe}),r.a.createElement(R,{path:"/user",component:F}),r.a.createElement(R,{path:"/update-profile",component:D}),r.a.createElement(C.b,{path:"/signup",component:N}),r.a.createElement(C.b,{path:"/login",component:_}),r.a.createElement(C.b,{path:"/forgot-password",component:B}))))};a(89);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ue,null)),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.27c9cdf9.chunk.js.map